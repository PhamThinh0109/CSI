<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ultimate Quiz - Chapter 5: Computer Organization</title>
    
    <!-- === CSS SECTION === -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;500;700&display=swap');

        :root {
            --primary-color: #0056b3;
            --primary-light: #007bff;
            --secondary-color: #e7f1ff;
            --correct-bg: #d4edda;
            --correct-text: #155724;
            --incorrect-bg: #f8d7da;
            --incorrect-text: #721c24;
            --bg-color: #f0f4f8;
            --card-bg: #ffffff;
            --text-color: #333;
            --border-radius: 15px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Be Vietnam Pro', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            padding: 20px;
        }

        .app-wrapper {
            display: flex;
            gap: 20px;
            max-width: 1200px;
            margin: auto;
            align-items: flex-start;
        }

        #key-terms-sidebar {
            flex: 0 0 300px;
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            padding: 20px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            position: sticky;
            top: 20px;
        }

        .sidebar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--secondary-color);
        }

        #key-terms-sidebar h2 { font-size: 20px; color: var(--primary-color); }
        
        #key-terms-lang-switch-btn {
            background-color: #f0f0f0;
            border: 1px solid #ccc;
            font-size: 12px;
            font-weight: bold;
            padding: 5px 10px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.2s;
        }
        #key-terms-lang-switch-btn:hover { background-color: #e0e0e0; }

        .term-item { margin-bottom: 10px; }

        .term-title {
            font-weight: 700;
            cursor: pointer;
            padding: 8px;
            border-radius: 5px;
            transition: background-color 0.2s;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .term-title:hover { background-color: var(--secondary-color); }
        .term-title .toggle-icon { font-weight: bold; transition: transform 0.2s; }

        .term-definition {
            font-size: 14px;
            line-height: 1.6;
            padding: 10px 8px 0 8px;
            display: none;
            border-top: 1px solid #eee;
            margin-top: 5px;
        }
        .term-item.active .term-definition { display: block; }
        .term-item.active .toggle-icon { transform: rotate(45deg); }

        .main-content { flex: 1; }
        
        .header-controls { display: flex; justify-content: flex-end; margin-bottom: 10px; }

        #lang-switch-btn {
            background-color: var(--card-bg);
            border: 2px solid var(--primary-light);
            color: var(--primary-light);
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
        }
        #lang-switch-btn:hover { background-color: var(--primary-light); color: white; }

        .container {
            background-color: var(--card-bg);
            border-radius: var(--border-radius);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            width: 100%;
            padding: 30px;
            overflow: hidden;
        }

        h1 { font-size: 24px; color: var(--primary-color); text-align: center; margin-bottom: 20px; }
        #quiz-header { display: flex; justify-content: space-between; font-size: 16px; font-weight: 500; margin-bottom: 20px; }
        #question { font-size: 20px; font-weight: 500; margin-bottom: 25px; line-height: 1.5; }
        #answer-buttons { display: flex; flex-direction: column; gap: 10px; }

        .btn {
            background-color: #e7f1ff; border: 2px solid #b3d1ff; border-radius: 8px; color: var(--primary-color);
            padding: 15px; text-align: left; font-size: 16px; cursor: pointer; transition: all 0.3s ease; width: 100%;
        }
        .btn:hover:not(:disabled) { background-color: #b3d1ff; }

        .btn.correct { background-color: var(--correct-bg); color: var(--correct-text); border-color: var(--correct-text); }
        .btn.incorrect { background-color: var(--incorrect-bg); color: var(--incorrect-text); border-color: var(--incorrect-text); }

        #explanation-container { margin-top: 20px; padding: 15px; background-color: #f8f9fa; border-left: 5px solid var(--primary-light); border-radius: 5px; }
        #tip { font-style: italic; color: #5a6268; margin-top: 10px; }
        
        #next-btn, #restart-btn {
            background-color: var(--primary-light); color: white; font-weight: bold; border: none; border-radius: 8px;
            padding: 15px; font-size: 16px; cursor: pointer; width: 100%; margin-top: 20px;
        }
        #next-btn:hover, #restart-btn:hover { background-color: var(--primary-color); }
        .hide { display: none; }

        @media (max-width: 900px) {
            .app-wrapper { flex-direction: column-reverse; }
            #key-terms-sidebar { position: static; flex: 1; margin-top: 20px; }
        }
    </style>
</head>
<body>
    <!-- === HTML SECTION === -->
    <div class="app-wrapper">
        <aside id="key-terms-sidebar">
            <div class="sidebar-header">
                <h2 id="key-terms-title">Thuáº­t ngá»¯ chÃ­nh</h2>
                <button id="key-terms-lang-switch-btn">Anh / Viá»‡t</button>
            </div>
            <div id="key-terms-list"></div>
        </aside>

        <main class="main-content">
            <div class="header-controls">
                <button id="lang-switch-btn">Switch Language</button>
            </div>
            <div class="container">
                <h1 id="main-title">Quiz Chapter 5: Computer Organization</h1>
                <div class="quiz">
                    <div id="quiz-header">
                        <span id="question-counter">Question 1/20</span>
                        <span id="score-label">Score: 0</span>
                    </div>
                    <h2 id="question">Question will appear here</h2>
                    <div id="answer-buttons"></div>
                    <div id="explanation-container" class="hide">
                        <h3 id="explanation-title">Giáº£i thÃ­ch & Máº¹o nhá»›</h3>
                        <p id="explanation"></p>
                        <p id="tip"></p>
                    </div>
                    <button id="next-btn" class="hide">Next Question</button>
                </div>
                <div id="result-container" class="hide">
                    <h2 id="result-title">Complete!</h2>
                    <p id="result-text">Your final score is <span id="final-score"></span>/20.</p>
                    <p id="result-message"></p>
                    <button id="restart-btn">Restart Quiz</button>
                </div>
            </div>
        </main>
    </div>

    <!-- === JAVASCRIPT SECTION === -->
    <script>
        // --- DATA ---
        const keyTermsData = {
            'subsystems': { term_en: 'Computer Subsystems', term_vi: 'CÃ¡c há»‡ thá»‘ng con', def_vi: 'Ba thÃ nh pháº§n cÆ¡ báº£n cá»§a mÃ¡y tÃ­nh: Bá»™ xá»­ lÃ½ trung tÃ¢m (CPU), Bá»™ nhá»› chÃ­nh, vÃ  há»‡ thá»‘ng con Nháº­p/Xuáº¥t (I/O).', def_en: 'The three fundamental components of a computer: CPU, Main Memory, and the I/O subsystem.' },
            'cpu': { term_en: 'CPU', term_vi: 'CPU (Bá»™ xá»­ lÃ½ trung tÃ¢m)', def_vi: '"Bá»™ nÃ£o" cá»§a mÃ¡y tÃ­nh, thá»±c hiá»‡n cÃ¡c phÃ©p tÃ­nh, thi hÃ nh lá»‡nh vÃ  Ä‘iá»u khiá»ƒn cÃ¡c thÃ nh pháº§n khÃ¡c.', def_en: 'The "brain" of the computer that performs calculations, executes instructions, and controls other components.' },
            'alu': { term_en: 'ALU', term_vi: 'ALU (ÄÆ¡n vá»‹ Sá»‘ há»c & Logic)', def_vi: 'Má»™t bá»™ pháº­n cá»§a CPU, chuyÃªn thá»±c hiá»‡n cÃ¡c phÃ©p toÃ¡n sá»‘ há»c (nhÆ° cá»™ng) vÃ  cÃ¡c phÃ©p toÃ¡n logic (nhÆ° AND, OR).', def_en: 'A part of the CPU that carries out arithmetic and logic operations.' },
            'control_unit': { term_en: 'Control Unit', term_vi: 'ÄÆ¡n vá»‹ Äiá»u khiá»ƒn', def_vi: 'Má»™t thÃ nh pháº§n cá»§a CPU, chá»‰ Ä‘áº¡o vÃ  Ä‘iá»u phá»‘i háº§u háº¿t cÃ¡c hoáº¡t Ä‘á»™ng trong mÃ¡y tÃ­nh.', def_en: 'A component of the CPU that directs and coordinates operations.' },
            'registers': { term_en: 'Registers', term_vi: 'Thanh ghi', def_vi: 'CÃ¡c vá»‹ trÃ­ lÆ°u trá»¯ nhá», tá»‘c Ä‘á»™ cao bÃªn trong CPU, dÃ¹ng Ä‘á»ƒ giá»¯ táº¡m thá»i dá»¯ liá»‡u vÃ  lá»‡nh.', def_en: 'Small, high-speed storage locations within the CPU.' },
            'pc': { term_en: 'Program Counter (PC)', term_vi: 'Bá»™ Ä‘áº¿m chÆ°Æ¡ng trÃ¬nh (PC)', def_vi: 'Má»™t thanh ghi Ä‘áº·c biá»‡t trong CPU, chá»©a Ä‘á»‹a chá»‰ bá»™ nhá»› cá»§a lá»‡nh tiáº¿p theo sáº½ Ä‘Æ°á»£c thi hÃ nh.', def_en: 'A special register holding the memory address of the next instruction.' },
            'ram': { term_en: 'RAM', term_vi: 'RAM (Bá»™ nhá»› truy cáº­p ngáº«u nhiÃªn)', def_vi: 'Bá»™ nhá»› chÃ­nh, kháº£ biáº¿n (máº¥t dá»¯ liá»‡u khi táº¯t nguá»“n), dÃ¹ng Ä‘á»ƒ lÆ°u trá»¯ dá»¯ liá»‡u vÃ  chÆ°Æ¡ng trÃ¬nh Ä‘ang Ä‘Æ°á»£c sá»­ dá»¥ng.', def_en: 'The main, volatile memory for currently used data and programs.' },
            'rom': { term_en: 'ROM', term_vi: 'ROM (Bá»™ nhá»› chá»‰ Ä‘á»c)', def_vi: 'Bá»™ nhá»› báº¥t biáº¿n (khÃ´ng máº¥t dá»¯ liá»‡u), lÆ°u trá»¯ vÄ©nh viá»…n cÃ¡c chá»‰ dáº«n cho mÃ¡y tÃ­nh, vÃ­ dá»¥ nhÆ° BIOS.', def_en: 'Non-volatile memory that permanently stores instructions like the BIOS.' },
            'cache': { term_en: 'Cache Memory', term_vi: 'Bá»™ nhá»› Ä‘á»‡m (Cache)', def_vi: 'Má»™t bá»™ nhá»› nhá», ráº¥t nhanh, náº±m giá»¯a CPU vÃ  RAM Ä‘á»ƒ tÄƒng tá»‘c Ä‘á»™ truy cáº­p vÃ o dá»¯ liá»‡u thÆ°á»ng dÃ¹ng.', def_en: 'A small, very fast memory between the CPU and RAM to speed up access.' },
            'machine_cycle': { term_en: 'Machine Cycle', term_vi: 'Chu trÃ¬nh mÃ¡y', def_vi: 'Quy trÃ¬nh hoáº¡t Ä‘á»™ng cÆ¡ báº£n cá»§a CPU, bao gá»“m ba bÆ°á»›c: TÃ¬m náº¡p (Fetch), Giáº£i mÃ£ (Decode), vÃ  Thá»±c thi (Execute).', def_en: 'The basic operational process of a CPU: Fetch, Decode, and Execute.' },
            'bus': { term_en: 'Bus', term_vi: 'Bus (Tuyáº¿n)', def_vi: 'Há»‡ thá»‘ng truyá»n thÃ´ng chuyá»ƒn dá»¯ liá»‡u, Ä‘á»‹a chá»‰, vÃ  tÃ­n hiá»‡u Ä‘iá»u khiá»ƒn giá»¯a cÃ¡c thÃ nh pháº§n bÃªn trong mÃ¡y tÃ­nh.', def_en: 'A communication system that transfers data, addresses, and control signals between components.' },
            'cisc_risc': { term_en: 'CISC vs. RISC', term_vi: 'CISC vs. RISC', def_vi: 'Hai loáº¡i kiáº¿n trÃºc táº­p lá»‡nh. CISC (Phá»©c táº¡p) cÃ³ nhiá»u lá»‡nh phá»©c táº¡p. RISC (RÃºt gá»n) cÃ³ Ã­t lá»‡nh Ä‘Æ¡n giáº£n hÆ¡n.', def_en: 'Two instruction set architectures. CISC (Complex) has many complex instructions. RISC (Reduced) has fewer, simpler instructions.' },
            'pipelining': { term_en: 'Pipelining', term_vi: 'Ká»¹ thuáº­t Ä‘Æ°á»ng á»‘ng', def_vi: 'Ká»¹ thuáº­t trong Ä‘Ã³ nhiá»u lá»‡nh Ä‘Æ°á»£c thá»±c thi chá»“ng chÃ©o, giá»‘ng nhÆ° má»™t dÃ¢y chuyá»n láº¯p rÃ¡p, Ä‘á»ƒ tÄƒng thÃ´ng lÆ°á»£ng.', def_en: 'A technique where multiple instructions are overlapped in execution to increase throughput.' },
            'dma': { term_en: 'DMA', term_vi: 'DMA (Truy cáº­p bá»™ nhá»› trá»±c tiáº¿p)', def_vi: 'Cho phÃ©p cÃ¡c thiáº¿t bá»‹ I/O truyá»n dá»¯ liá»‡u trá»±c tiáº¿p Ä‘áº¿n/tá»« bá»™ nhá»› chÃ­nh mÃ  khÃ´ng cáº§n sá»± can thiá»‡p liÃªn tá»¥c cá»§a CPU.', def_en: 'Allows I/O devices to transfer data directly to/from main memory without constant CPU intervention.' }
        };

        // Full question bank in dual language
        const fullQuestionBank = [
             {
                question_en: "What are the three main subsystems of a stand-alone computer?", question_vi: "Ba há»‡ thá»‘ng con chÃ­nh cá»§a má»™t mÃ¡y tÃ­nh Ä‘á»™c láº­p lÃ  gÃ¬?",
                answers_en: [ { text: "CPU, Keyboard, and Monitor", correct: false }, { text: "CPU, Main Memory, and I/O Subsystem", correct: true }, { text: "ALU, Control Unit, and Registers", correct: false }, { text: "RAM, ROM, and Cache", correct: false } ],
                answers_vi: [ { text: "CPU, BÃ n phÃ­m, vÃ  MÃ n hÃ¬nh", correct: false }, { text: "CPU, Bá»™ nhá»› chÃ­nh, vÃ  Há»‡ thá»‘ng con I/O", correct: true }, { text: "ALU, ÄÆ¡n vá»‹ Ä‘iá»u khiá»ƒn, vÃ  Thanh ghi", correct: false }, { text: "RAM, ROM, vÃ  Cache", correct: false } ],
                explanation_vi: "Má»™t mÃ¡y tÃ­nh hoÃ n chá»‰nh bao gá»“m ba khá»‘i chá»©c nÄƒng cÆ¡ báº£n: Bá»™ xá»­ lÃ½ trung tÃ¢m (CPU) Ä‘á»ƒ xá»­ lÃ½, Bá»™ nhá»› chÃ­nh Ä‘á»ƒ lÆ°u trá»¯ táº¡m thá»i, vÃ  há»‡ thá»‘ng Nháº­p/Xuáº¥t (I/O) Ä‘á»ƒ tÆ°Æ¡ng tÃ¡c vá»›i bÃªn ngoÃ i.",
                tip: "Máº¹o nhá»›: HÃ£y tÆ°á»Ÿng tÆ°á»£ng cÆ¡ thá»ƒ ngÆ°á»i. CPU lÃ  bá»™ nÃ£o (xá»­ lÃ½), Bá»™ nhá»› lÃ  trÃ­ nhá»› ngáº¯n háº¡n (lÆ°u trá»¯), vÃ  cÃ¡c giÃ¡c quan (máº¯t, tai, tay) lÃ  há»‡ thá»‘ng I/O (tÆ°Æ¡ng tÃ¡c).",
                keyTerms: ['subsystems', 'cpu', 'ram']
            },
            {
                question_en: "Which component of the CPU performs arithmetic and logical operations?", question_vi: "ThÃ nh pháº§n nÃ o cá»§a CPU thá»±c hiá»‡n cÃ¡c phÃ©p toÃ¡n sá»‘ há»c vÃ  logic?",
                answers_en: [ { text: "Control Unit", correct: false }, { text: "Registers", correct: false }, { text: "Arithmetic Logic Unit (ALU)", correct: true }, { text: "System Bus", correct: false } ],
                answers_vi: [ { text: "ÄÆ¡n vá»‹ Ä‘iá»u khiá»ƒn", correct: false }, { text: "CÃ¡c thanh ghi", correct: false }, { text: "ÄÆ¡n vá»‹ sá»‘ há»c vÃ  logic (ALU)", correct: true }, { text: "Bus há»‡ thá»‘ng", correct: false } ],
                explanation_vi: "ALU lÃ  'mÃ¡y tÃ­nh' bÃªn trong CPU, chuyÃªn thá»±c hiá»‡n cÃ¡c phÃ©p tÃ­nh cá»™ng, trá»«, vÃ  cÃ¡c phÃ©p toÃ¡n logic nhÆ° AND, OR, NOT.",
                tip: "Máº¹o nhá»›: Chá»¯ 'A' trong ALU lÃ  'Arithmetic' (Sá»‘ há»c) vÃ  chá»¯ 'L' lÃ  'Logic'. TÃªn cá»§a nÃ³ Ä‘Ã£ nÃ³i lÃªn chá»©c nÄƒng chÃ­nh.",
                keyTerms: ['cpu', 'alu', 'control_unit', 'registers']
            },
            {
                question_en: "What is the function of the Program Counter (PC)?", question_vi: "Chá»©c nÄƒng cá»§a Bá»™ Ä‘áº¿m chÆ°Æ¡ng trÃ¬nh (PC) lÃ  gÃ¬?",
                answers_en: [ { text: "To store the current instruction", correct: false }, { text: "To decode instructions", correct: false }, { text: "To hold the address of the next instruction", correct: true }, { text: "To store operation results", correct: false } ],
                answers_vi: [ { text: "LÆ°u trá»¯ lá»‡nh hiá»‡n táº¡i", correct: false }, { text: "Giáº£i mÃ£ lá»‡nh", correct: false }, { text: "Giá»¯ Ä‘á»‹a chá»‰ cá»§a lá»‡nh tiáº¿p theo", correct: true }, { text: "LÆ°u trá»¯ káº¿t quáº£ phÃ©p toÃ¡n", correct: false } ],
                explanation_vi: "Bá»™ Ä‘áº¿m chÆ°Æ¡ng trÃ¬nh (PC) lÃ  má»™t thanh ghi Ä‘áº·c biá»‡t, luÃ´n trá» Ä‘áº¿n Ä‘á»‹a chá»‰ bá»™ nhá»› cá»§a lá»‡nh káº¿ tiáº¿p mÃ  CPU cáº§n tÃ¬m náº¡p vÃ  thá»±c thi.",
                tip: "Máº¹o nhá»›: HÃ£y nghÄ© PC nhÆ° má»™t 'dáº¥u trang sÃ¡ch'. NÃ³ luÃ´n Ä‘Ã¡nh dáº¥u trang (lá»‡nh) tiáº¿p theo báº¡n cáº§n Ä‘á»c.",
                keyTerms: ['cpu', 'registers', 'pc']
            },
            {
                question_en: "Which type of memory is 'volatile'?", question_vi: "Loáº¡i bá»™ nhá»› nÃ o lÃ  'kháº£ biáº¿n'?",
                answers_en: [ { text: "ROM", correct: false }, { text: "RAM", correct: true }, { text: "SSD", correct: false }, { text: "EEPROM", correct: false } ],
                answers_vi: [ { text: "ROM", correct: false }, { text: "RAM", correct: true }, { text: "SSD", correct: false }, { text: "EEPROM", correct: false } ],
                explanation_vi: "RAM (Bá»™ nhá»› truy cáº­p ngáº«u nhiÃªn) lÃ  kháº£ biáº¿n, nghÄ©a lÃ  ná»™i dung cá»§a nÃ³ sáº½ máº¥t khi táº¯t nguá»“n. ROM vÃ  bá»™ nhá»› flash lÃ  báº¥t biáº¿n.",
                tip: "Máº¹o nhá»›: RAM giá»‘ng nhÆ° 'báº£ng nhÃ¡p' cá»§a báº¡n. Báº¡n viáº¿t lÃªn Ä‘Ã³ Ä‘á»ƒ lÃ m viá»‡c, nhÆ°ng khi xong viá»‡c (táº¯t mÃ¡y), báº¡n sáº½ lau sáº¡ch nÃ³.",
                keyTerms: ['ram', 'rom', 'cache']
            },
            {
                question_en: "What is the primary purpose of Cache Memory?", question_vi: "Má»¥c Ä‘Ã­ch chÃ­nh cá»§a Bá»™ nhá»› Ä‘á»‡m (Cache) lÃ  gÃ¬?",
                answers_en: [ { text: "To store data permanently", correct: false }, { text: "To speed up data access for the CPU", correct: true }, { text: "To store the BIOS program", correct: false }, { text: "To replace RAM", correct: false } ],
                answers_vi: [ { text: "LÆ°u trá»¯ dá»¯ liá»‡u vÄ©nh viá»…n", correct: false }, { text: "TÄƒng tá»‘c Ä‘á»™ truy cáº­p dá»¯ liá»‡u cho CPU", correct: true }, { text: "LÆ°u trá»¯ chÆ°Æ¡ng trÃ¬nh BIOS", correct: false }, { text: "Thay tháº¿ hoÃ n toÃ n RAM", correct: false } ],
                explanation_vi: "Cache lÃ  má»™t bá»™ nhá»› nhá», siÃªu nhanh náº±m giá»¯a CPU vÃ  RAM. NÃ³ lÆ°u trá»¯ cÃ¡c dá»¯ liá»‡u Ä‘Æ°á»£c truy cáº­p thÆ°á»ng xuyÃªn, giÃºp CPU láº¥y thÃ´ng tin nhanh hÆ¡n nhiá»u so vá»›i viá»‡c pháº£i chá» tá»« RAM.",
                tip: "Máº¹o nhá»›: Cache giá»‘ng nhÆ° 'tá»§ Ä‘á»“ nhá»' ngay cáº¡nh bÃ n lÃ m viá»‡c cá»§a báº¡n, chá»©a nhá»¯ng cÃ´ng cá»¥ hay dÃ¹ng nháº¥t Ä‘á»ƒ khÃ´ng pháº£i cháº¡y xuá»‘ng nhÃ  kho (RAM).",
                keyTerms: ['cache', 'cpu', 'ram']
            },
            {
                question_en: "The CPU's machine cycle consists of which three stages in order?", question_vi: "Chu trÃ¬nh mÃ¡y cá»§a CPU bao gá»“m ba giai Ä‘oáº¡n nÃ o theo thá»© tá»±?",
                answers_en: [ { text: "Execute, Decode, Fetch", correct: false }, { text: "Fetch, Decode, Execute", correct: true }, { text: "Decode, Fetch, Execute", correct: false }, { text: "Fetch, Store, Decode", correct: false } ],
                answers_vi: [ { text: "Thá»±c thi, Giáº£i mÃ£, TÃ¬m náº¡p", correct: false }, { text: "TÃ¬m náº¡p, Giáº£i mÃ£, Thá»±c thi", correct: true }, { text: "Giáº£i mÃ£, TÃ¬m náº¡p, Thá»±c thi", correct: false }, { text: "TÃ¬m náº¡p, LÆ°u trá»¯, Giáº£i mÃ£", correct: false } ],
                explanation_vi: "CPU hoáº¡t Ä‘á»™ng theo chu trÃ¬nh láº·p láº¡i: 1. Fetch: Láº¥y lá»‡nh tá»« bá»™ nhá»›. 2. Decode: 'Äá»c' vÃ  hiá»ƒu lá»‡nh. 3. Execute: Thá»±c hiá»‡n hÃ nh Ä‘á»™ng.",
                tip: "Máº¹o nhá»›: TÆ°á»Ÿng tÆ°á»£ng báº¡n Ä‘ang gá»i mÃ³n: 1. Fetch (TÃ¬m náº¡p): Báº¡n láº¥y thá»±c Ä‘Æ¡n. 2. Decode (Giáº£i mÃ£): Báº¡n Ä‘á»c vÃ  quyáº¿t Ä‘á»‹nh mÃ³n. 3. Execute (Thá»±c thi): NhÃ  báº¿p thá»±c hiá»‡n nÃ³.",
                keyTerms: ['machine_cycle', 'cpu', 'control_unit']
            },
            {
                question_en: "Which computer architecture uses a large, complex set of instructions?", question_vi: "Kiáº¿n trÃºc mÃ¡y tÃ­nh nÃ o sá»­ dá»¥ng má»™t táº­p lá»‡nh lá»›n vÃ  phá»©c táº¡p?",
                answers_en: [ { text: "RISC", correct: false }, { text: "CISC", correct: true }, { text: "SIMD", correct: false }, { text: "MIMD", correct: false } ],
                answers_vi: [ { text: "RISC", correct: false }, { text: "CISC", correct: true }, { text: "SIMD", correct: false }, { text: "MIMD", correct: false } ],
                explanation_vi: "CISC (MÃ¡y tÃ­nh táº­p lá»‡nh phá»©c táº¡p) cÃ³ má»¥c tiÃªu hoÃ n thÃ nh má»™t tÃ¡c vá»¥ trong Ã­t dÃ²ng mÃ£ há»£p ngá»¯ nháº¥t cÃ³ thá»ƒ, báº±ng cÃ¡ch sá»­ dá»¥ng cÃ¡c lá»‡nh máº¡nh máº½, phá»©c táº¡p.",
                tip: "Máº¹o nhá»›: 'C' trong CISC lÃ  'Complex' (Phá»©c táº¡p). NgÆ°á»£c láº¡i, 'R' trong RISC lÃ  'Reduced' (RÃºt gá»n).",
                keyTerms: ['cisc_risc']
            },
            {
                question_en: "How does 'Pipelining' improve CPU performance?", question_vi: "Ká»¹ thuáº­t 'ÄÆ°á»ng á»‘ng' (Pipelining) cáº£i thiá»‡n hiá»‡u suáº¥t CPU báº±ng cÃ¡ch nÃ o?",
                answers_en: [ { text: "By increasing clock speed", correct: false }, { text: "By using multiple cores", correct: false }, { text: "By overlapping the execution of multiple instructions", correct: true }, { text: "By simplifying instructions", correct: false } ],
                answers_vi: [ { text: "Báº±ng cÃ¡ch tÄƒng tá»‘c Ä‘á»™ xung nhá»‹p", correct: false }, { text: "Báº±ng cÃ¡ch sá»­ dá»¥ng nhiá»u lÃµi", correct: false }, { text: "Báº±ng cÃ¡ch thá»±c thi chá»“ng chÃ©o nhiá»u lá»‡nh", correct: true }, { text: "Báº±ng cÃ¡ch Ä‘Æ¡n giáº£n hÃ³a lá»‡nh", correct: false } ],
                explanation_vi: "Pipelining hoáº¡t Ä‘á»™ng nhÆ° má»™t dÃ¢y chuyá»n láº¯p rÃ¡p, cho phÃ©p cÃ¡c giai Ä‘oáº¡n khÃ¡c nhau (TÃ¬m náº¡p, Giáº£i mÃ£, Thá»±c thi) cá»§a nhiá»u lá»‡nh Ä‘Æ°á»£c xá»­ lÃ½ Ä‘á»“ng thá»i.",
                tip: "Máº¹o nhá»›: HÃ£y nghÄ© Ä‘áº¿n viá»‡c rá»­a bÃ¡t: má»™t ngÆ°á»i trÃ¡ng, má»™t ngÆ°á»i rá»­a, má»™t ngÆ°á»i lau. Ba ngÆ°á»i lÃ m song song sáº½ nhanh hÆ¡n nhiá»u. ÄÃ³ chÃ­nh lÃ  Pipelining.",
                keyTerms: ['pipelining', 'cpu', 'machine_cycle']
            },
            {
                question_en: "What does DMA stand for?", question_vi: "DMA lÃ  viáº¿t táº¯t cá»§a tá»« gÃ¬?",
                answers_en: [ { text: "Direct Memory Access", correct: true }, { text: "Data Management Array", correct: false }, { text: "Dynamic Memory Allocation", correct: false }, { text: "Digital Media Adapter", correct: false } ],
                answers_vi: [ { text: "Truy cáº­p bá»™ nhá»› trá»±c tiáº¿p", correct: true }, { text: "Máº£ng quáº£n lÃ½ dá»¯ liá»‡u", correct: false }, { text: "Cáº¥p phÃ¡t bá»™ nhá»› Ä‘á»™ng", correct: false }, { text: "Bá»™ Ä‘iá»u há»£p phÆ°Æ¡ng tiá»‡n ká»¹ thuáº­t sá»‘", correct: false } ],
                explanation_vi: "Truy cáº­p bá»™ nhá»› trá»±c tiáº¿p (DMA) cho phÃ©p cÃ¡c thiáº¿t bá»‹ I/O truyá»n dá»¯ liá»‡u trá»±c tiáº¿p Ä‘áº¿n/tá»« bá»™ nhá»› chÃ­nh mÃ  khÃ´ng cáº§n sá»± can thiá»‡p liÃªn tá»¥c cá»§a CPU, giÃºp giáº£i phÃ³ng CPU cho cÃ¡c tÃ¡c vá»¥ khÃ¡c.",
                tip: "Máº¹o nhá»›: TÃªn 'Direct Memory Access' Ä‘Ã£ nÃ³i lÃªn táº¥t cáº£. Dá»¯ liá»‡u Ä‘i 'trá»±c tiáº¿p' vÃ o bá»™ nhá»›, khÃ´ng cáº§n CPU 'dáº«n Ä‘Æ°á»ng' tá»«ng bÆ°á»›c.",
                keyTerms: ['dma', 'bus', 'ram']
            },
            {
                question_en: "Which bus carries memory addresses?", question_vi: "Bus nÃ o mang Ä‘á»‹a chá»‰ bá»™ nhá»›?",
                answers_en: [ { text: "Data Bus", correct: false }, { text: "Control Bus", correct: false }, { text: "Address Bus", correct: true }, { text: "I/O Bus", correct: false } ],
                answers_vi: [ { text: "Bus Dá»¯ liá»‡u", correct: false }, { text: "Bus Äiá»u khiá»ƒn", correct: false }, { text: "Bus Äá»‹a chá»‰", correct: true }, { text: "Bus I/O", correct: false } ],
                explanation_vi: "Bus Äá»‹a chá»‰ lÃ  má»™t bus Ä‘Æ¡n hÆ°á»›ng, mang Ä‘á»‹a chá»‰ bá»™ nhá»› tá»« CPU Ä‘áº¿n cÃ¡c thÃ nh pháº§n khÃ¡c nhÆ° RAM vÃ  bá»™ Ä‘iá»u khiá»ƒn I/O.",
                tip: "Máº¹o nhá»›: Address Bus chá»‰ 'Ä‘á»‹a chá»‰ giao hÃ ng'. Data Bus chá»Ÿ 'hÃ ng hÃ³a'. Control Bus lÃ  'tÃ­n hiá»‡u giao thÃ´ng'.",
                keyTerms: ['bus']
            },
             {
                question_en: "What is the key difference between SRAM and DRAM?",
                question_vi: "Sá»± khÃ¡c biá»‡t chÃ­nh giá»¯a SRAM vÃ  DRAM lÃ  gÃ¬?",
                answers_en: [ { text: "SRAM is volatile, DRAM is not", correct: false }, { text: "SRAM is faster and more expensive", correct: true }, { text: "DRAM is used for cache, SRAM for main memory", correct: false }, { text: "SRAM needs refreshing", correct: false } ],
                answers_vi: [ { text: "SRAM kháº£ biáº¿n, DRAM thÃ¬ khÃ´ng", correct: false }, { text: "SRAM nhanh hÆ¡n vÃ  Ä‘áº¯t hÆ¡n", correct: true }, { text: "DRAM dÃ¹ng cho cache, SRAM cho bá»™ nhá»› chÃ­nh", correct: false }, { text: "SRAM cáº§n lÃ m má»›i", correct: false } ],
                explanation_vi: "SRAM (RAM tÄ©nh) dÃ¹ng flip-flop, ráº¥t nhanh, khÃ´ng cáº§n lÃ m má»›i, lÃ½ tÆ°á»Ÿng cho cache. DRAM (RAM Ä‘á»™ng) dÃ¹ng tá»¥ Ä‘iá»‡n, cháº­m hÆ¡n, ráº» hÆ¡n, vÃ  cáº§n lÃ m má»›i liÃªn tá»¥c, phÃ¹ há»£p cho bá»™ nhá»› chÃ­nh.",
                tip: "Máº¹o nhá»›: 'S' trong SRAM lÃ  'Static' (TÄ©nh) - dá»¯ liá»‡u 'Ä‘á»©ng yÃªn', khÃ´ng cáº§n lÃ m má»›i. 'D' trong DRAM lÃ  'Dynamic' (Äá»™ng) - dá»¯ liá»‡u cáº§n Ä‘Æ°á»£c 'lÃ m má»›i' liÃªn tá»¥c.",
                keyTerms: ['ram', 'cache']
            }
        ];
        // To ensure we have enough questions for a 20-question quiz
        const finalQuestionBank = [...fullQuestionBank, ...fullQuestionBank];

        // --- DOM ELEMENTS & STATE ---
        let mainLang = 'en';
        let keyTermsLang = 'vi';
        let shuffledQuestions, currentQuestionIndex;
        let score = 0;
        const totalQuestions = 20;
        let currentKeyTerms = [];

        const elements = {
            langSwitchBtn: document.getElementById('lang-switch-btn'),
            keyTermsLangSwitchBtn: document.getElementById('key-terms-lang-switch-btn'),
            mainTitle: document.getElementById('main-title'),
            questionCounter: document.getElementById('question-counter'),
            scoreLabel: document.getElementById('score-label'),
            question: document.getElementById('question'),
            answerButtons: document.getElementById('answer-buttons'),
            explanationContainer: document.getElementById('explanation-container'),
            explanationTitle: document.getElementById('explanation-title'),
            explanation: document.getElementById('explanation'),
            tip: document.getElementById('tip'),
            nextBtn: document.getElementById('next-btn'),
            quizContainer: document.querySelector('.quiz'),
            resultContainer: document.getElementById('result-container'),
            resultTitle: document.getElementById('result-title'),
            resultText: document.getElementById('result-text'),
            finalScore: document.getElementById('final-score'),
            resultMessage: document.getElementById('result-message'),
            restartBtn: document.getElementById('restart-btn'),
            keyTermsTitle: document.getElementById('key-terms-title'),
            keyTermsList: document.getElementById('key-terms-list')
        };
        
        const uiText = {
            en: { mainTitle: "Quiz Chapter 5: Computer Organization", questionCounter: "Question", scoreLabel: "Score", nextBtn: "Next Question", resultTitle: "Complete!", resultText: "Your final score is", restartBtn: "Restart Quiz" },
            vi: { mainTitle: "Tráº¯c nghiá»‡m ChÆ°Æ¡ng 5: Tá»• chá»©c MÃ¡y tÃ­nh", questionCounter: "CÃ¢u", scoreLabel: "Äiá»ƒm", nextBtn: "CÃ¢u tiáº¿p theo", resultTitle: "HoÃ n thÃ nh!", resultText: "Äiá»ƒm cuá»‘i cÃ¹ng cá»§a báº¡n lÃ ", restartBtn: "LÃ m láº¡i" }
        };
        const resultMessages = {
            en: { perfect: "Excellent!", great: "Great job!", good: "Good effort!", retry: "Keep trying!" },
            vi: { perfect: "Xuáº¥t sáº¯c!", great: "Ráº¥t tá»‘t!", good: "KhÃ¡ á»•n!", retry: "Cáº§n cá»‘ gáº¯ng hÆ¡n!" }
        };

        // --- FUNCTIONS ---
        function toggleMainLanguage() {
            mainLang = (mainLang === 'en') ? 'vi' : 'en';
            updateMainUIText();
        }
        
        function toggleKeyTermsLanguage() {
            keyTermsLang = (keyTermsLang === 'vi') ? 'en' : 'vi';
            populateKeyTerms(currentKeyTerms, false); // Re-render terms with new language
        }

        function updateMainUIText() {
            const texts = uiText[mainLang];
            elements.mainTitle.innerText = texts.mainTitle;
            elements.scoreLabel.innerText = `${texts.scoreLabel}: ${score}`;
            elements.nextBtn.innerText = texts.nextBtn;
            elements.resultTitle.innerText = texts.resultTitle;
            elements.restartBtn.innerText = texts.restartBtn;

            if (!elements.quizContainer.classList.contains('hide')) { showQuestion(false); }
            if (!elements.resultContainer.classList.contains('hide')) { showResult(false); }
        }
        
        function startQuiz() {
            score = 0;
            currentQuestionIndex = 0;
            shuffledQuestions = finalQuestionBank.sort(() => Math.random() - 0.5).slice(0, totalQuestions);
            
            elements.quizContainer.classList.remove('hide');
            elements.resultContainer.classList.add('hide');
            elements.scoreLabel.innerText = `${uiText[mainLang].scoreLabel}: ${score}`;
            showQuestion(true);
        }

        function showQuestion(isNewQuestion = true) {
            if (isNewQuestion) resetState();
            else {
                while (elements.answerButtons.firstChild) {
                    elements.answerButtons.removeChild(elements.answerButtons.firstChild);
                }
            }

            let currentQuestion = shuffledQuestions[currentQuestionIndex];
            currentKeyTerms = currentQuestion.keyTerms; // Store current terms for language switch
            let questionNo = currentQuestionIndex + 1;

            elements.question.innerHTML = `${questionNo}. ${currentQuestion['question_' + mainLang]}`;
            elements.questionCounter.innerText = `${uiText[mainLang].questionCounter} ${questionNo}/${totalQuestions}`;

            const answers = currentQuestion['answers_' + mainLang];
            answers.forEach((answer, index) => {
                const button = document.createElement('button');
                button.innerHTML = answer.text;
                button.classList.add('btn');
                elements.answerButtons.appendChild(button);
                if (currentQuestion.answers_en[index].correct) { button.dataset.correct = "true"; }
                button.addEventListener('click', selectAnswer);
            });
            
            populateKeyTerms(currentKeyTerms, true);
        }

        function resetState() {
            elements.explanationContainer.classList.add('hide');
            elements.nextBtn.classList.add('hide');
            while (elements.answerButtons.firstChild) {
                elements.answerButtons.removeChild(elements.answerButtons.firstChild);
            }
        }

        function selectAnswer(e) {
            const selectedBtn = e.target;
            const isCorrect = selectedBtn.dataset.correct === "true";

            if (isCorrect) {
                selectedBtn.classList.add('correct');
                score++;
                elements.scoreLabel.innerText = `${uiText[mainLang].scoreLabel}: ${score}`;
            } else {
                selectedBtn.classList.add('incorrect');
            }

            Array.from(elements.answerButtons.children).forEach(button => {
                if (button.dataset.correct === "true") button.classList.add('correct');
                button.disabled = true;
            });
            
            const currentQuestion = shuffledQuestions[currentQuestionIndex];
            // Explanation and tip are ALWAYS in Vietnamese per requirement
            elements.explanation.innerText = currentQuestion.explanation_vi;
            elements.tip.innerText = "ðŸ’¡ " + currentQuestion.tip;
            elements.explanationContainer.classList.remove('hide');
            elements.nextBtn.classList.remove('hide');
        }

        function showResult(updateOnly = false) {
             if (!updateOnly) {
                elements.quizContainer.classList.add('hide');
                elements.resultContainer.classList.add('hide');
                elements.keyTermsList.innerHTML = ''; // Clear key terms on result page
            }

            const mainTexts = uiText[mainLang];
            const resultMsgTexts = resultMessages[mainLang];
            elements.resultText.innerHTML = `${mainTexts.resultText} <span id="final-score">${score}</span>/${totalQuestions}.`;
            
            const percentage = (score / totalQuestions) * 100;
            let messageKey = 'retry';
            if (percentage === 100) messageKey = 'perfect';
            else if (percentage >= 80) messageKey = 'great';
            else if (percentage >= 50) messageKey = 'good';
            
            elements.resultMessage.innerText = resultMsgTexts[messageKey];
        }

        function handleNextButton() {
            currentQuestionIndex++;
            if (currentQuestionIndex < totalQuestions) { showQuestion(true); } 
            else { showResult(); }
        }
        
        function populateKeyTerms(termsArray, isNew = true) {
            if(isNew) elements.keyTermsList.innerHTML = '';
            elements.keyTermsTitle.innerText = keyTermsLang === 'vi' ? 'Thuáº­t ngá»¯ chÃ­nh' : 'Key Terms';
            
            if (!termsArray) return;
            
            termsArray.forEach((termKey, index) => {
                const termData = keyTermsData[termKey];
                if(isNew){
                    const termItem = document.createElement('div');
                    termItem.classList.add('term-item');
                    termItem.innerHTML = `
                        <div class="term-title">
                            <span>${termData['term_' + keyTermsLang]}</span>
                            <span class="toggle-icon">+</span>
                        </div>
                        <p class="term-definition">${termData['def_' + keyTermsLang]}</p>
                    `;
                    elements.keyTermsList.appendChild(termItem);

                    termItem.querySelector('.term-title').addEventListener('click', () => {
                        termItem.classList.toggle('active');
                    });
                } else {
                    const termItem = elements.keyTermsList.children[index];
                    termItem.querySelector('.term-title span:first-child').innerText = termData['term_' + keyTermsLang];
                    termItem.querySelector('.term-definition').innerText = termData['def_' + keyTermsLang];
                }
            });
        }

        // --- EVENT LISTENERS ---
        elements.langSwitchBtn.addEventListener('click', toggleMainLanguage);
        elements.keyTermsLangSwitchBtn.addEventListener('click', toggleKeyTermsLanguage);
        elements.nextBtn.addEventListener('click', handleNextButton);
        elements.restartBtn.addEventListener('click', startQuiz);

        // --- INITIALIZE ---
        startQuiz();
    </script>
</body>
</html>

