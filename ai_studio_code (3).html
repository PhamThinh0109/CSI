<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tr·∫Øc Nghi·ªám Ki·∫øn Th·ª©c M√°y T√≠nh</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üß†</text></svg>">
    
    <!-- ======================= CSS STYLES ======================= -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;600;700&display=swap');

        :root {
            --primary-color: #3B71CA;
            --secondary-color: #9FA6B2;
            --background-color: #F0F2F5;
            --card-background: #FFFFFF;
            --text-color: #212529;
            --correct-color: #14A44D;
            --incorrect-color: #DC4C64;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Be Vietnam Pro', sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        .quiz-container {
            position: relative;
            background-color: var(--card-background);
            border-radius: 16px;
            box-shadow: var(--shadow);
            width: 100%;
            max-width: 800px;
            overflow: hidden;
        }

        #translate-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background-color: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid white;
            border-radius: 8px;
            padding: 8px 12px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
            z-index: 10;
        }
        #translate-btn:hover {
            background-color: rgba(255, 255, 255, 0.3);
        }

        .header {
            background: linear-gradient(135deg, #4776E6, #8E54E9);
            color: white;
            padding: 25px 30px;
            text-align: center;
        }

        .header h1 {
            margin: 0;
            font-size: 1.8rem;
        }
        .header p {
            margin: 5px 0 0;
            opacity: 0.9;
        }

        .main-content {
            padding: 30px;
        }

        #start-screen h2, #score-screen h2 {
            text-align: center;
            color: var(--primary-color);
            margin-top: 0;
        }
        #start-screen p, #score-screen p {
            text-align: center;
            line-height: 1.6;
            color: #6c757d;
        }

        .quiz-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            font-weight: 600;
            color: #555;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }

        #question {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 25px;
            line-height: 1.5;
        }

        #options-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 15px;
        }

        .option-btn {
            width: 100%;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            background-color: var(--card-background);
            cursor: pointer;
            text-align: left;
            font-size: 1rem;
            font-family: inherit;
            transition: all 0.2s ease-in-out;
        }

        .option-btn:hover:not([disabled]) {
            border-color: var(--primary-color);
            transform: translateY(-2px);
        }

        .option-btn.correct {
            background-color: #E7F6EC;
            border-color: var(--correct-color);
            color: var(--correct-color);
            font-weight: 600;
        }

        .option-btn.incorrect {
            background-color: #FBE9EC;
            border-color: var(--incorrect-color);
            color: var(--incorrect-color);
            font-weight: 600;
        }

        .option-btn:disabled {
            cursor: not-allowed;
            opacity: 0.9;
        }

        .btn {
            display: block;
            width: 220px;
            margin: 30px auto 0;
            padding: 15px 20px;
            border: none;
            border-radius: 50px;
            background-color: var(--primary-color);
            color: white;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn:hover {
            background-color: #2F5AB1;
            box-shadow: 0 4px 10px rgba(59, 113, 202, 0.4);
        }

        #result-container {
            margin-top: 25px;
            padding: 20px;
            border-radius: 10px;
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            line-height: 1.6;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        #result-container h3 {
            margin-top: 0;
            font-size: 1.2rem;
        }

        #result-container .explanation, #result-container .memory-tip {
            margin-bottom: 15px;
        }
        #result-container .memory-tip {
            background-color: #FFF9C4;
            border-left: 4px solid #FBC02D;
            padding: 15px;
            border-radius: 4px;
        }
        #result-container .memory-tip h4 {
            color: #F57F17;
        }

        #final-score {
            font-size: 1.8rem;
            font-weight: 700;
            text-align: center;
            color: var(--primary-color);
        }
        #final-message {
            font-size: 1.1rem;
        }

        .hide {
            display: none;
        }
    </style>
</head>
<body>

    <div class="quiz-container">
        <button id="translate-btn">EN</button>
        <div class="header">
            <h1 data-key="main_title">Ki·ªÉm Tra Ki·∫øn Th·ª©c M√°y T√≠nh</h1>
            <p data-key="main_subtitle">Ch∆∞∆°ng 1 & 5</p>
        </div>
        <div class="main-content">
            <div id="start-screen">
                <h2 data-key="welcome_title">B·∫°n ƒë√£ s·∫µn s√†ng ƒë·ªÉ ki·ªÉm tra ki·∫øn th·ª©c c·ªßa m√¨nh?</h2>
                <p data-key="welcome_desc">H·ªá th·ªëng s·∫Ω ch·ªçn ng·∫´u nhi√™n <strong>20 c√¢u h·ªèi</strong> t·ª´ ng√¢n h√†ng c√¢u h·ªèi v·ªÅ c√°c kh√°i ni·ªám n·ªÅn t·∫£ng v√† t·ªï ch·ª©c m√°y t√≠nh.</p>
                <button id="start-btn" class="btn" data-key="start_btn">B·∫Øt ƒê·∫ßu</button>
            </div>

            <div id="quiz-screen" class="hide">
                <div class="quiz-header">
                    <span id="question-counter"></span>
                    <span id="score-counter"></span>
                </div>
                <h2 id="question"></h2>
                <div id="options-container"></div>
                <div id="result-container" class="hide">
                    <h3 id="result-text"></h3>
                    <div class="explanation">
                        <h4 data-key="explanation_title">üìù Gi·∫£i th√≠ch:</h4>
                        <p id="explanation-text"></p>
                    </div>
                     <div class="memory-tip">
                        <h4 data-key="tip_title">üí° M·∫πo ghi nh·ªõ:</h4>
                        <p id="tip-text"></p>
                    </div>
                </div>
                <button id="next-btn" class="btn hide" data-key="next_btn">C√¢u ti·∫øp theo</button>
            </div>

            <div id="score-screen" class="hide">
                <h2 data-key="end_title">Ho√†n th√†nh b√†i ki·ªÉm tra!</h2>
                <p id="final-score"></p>
                <p id="final-message"></p>
                <button id="restart-btn" class="btn" data-key="restart_btn">L√†m l·∫°i t·ª´ ƒë·∫ßu</button>
            </div>
        </div>
    </div>

    <!-- ======================= JAVASCRIPT LOGIC ======================= -->
    <script>
        const quizApp = {
            // --- NG√ÇN H√ÄNG C√ÇU H·ªéI ƒêA NG√îN NG·ªÆ ---
            questionBank: [
                 { question: { vi: "√ù t∆∞·ªüng c·ªët l√µi nh·∫•t c·ªßa m√¥ h√¨nh Turing l√† g√¨?", en: "What is the most core idea of the Turing model?" }, options: [{ vi: "M√°y t√≠nh c√≥ 4 th√†nh ph·∫ßn ch√≠nh", en: "A computer has 4 main components" }, { vi: "Ch∆∞∆°ng tr√¨nh ƒë∆∞·ª£c l∆∞u trong b·ªô nh·ªõ", en: "Programs are stored in memory" }, { vi: "M√°y t√≠nh l√† m·ªôt b·ªô x·ª≠ l√Ω d·ªØ li·ªáu c√≥ th·ªÉ l·∫≠p tr√¨nh", en: "A computer is a programmable data processor" }, { vi: "M√°y t√≠nh s·ª≠ d·ª•ng b√≥ng b√°n d·∫´n", en: "A computer uses transistors" }], answer: { vi: "M√°y t√≠nh l√† m·ªôt b·ªô x·ª≠ l√Ω d·ªØ li·ªáu c√≥ th·ªÉ l·∫≠p tr√¨nh", en: "A computer is a programmable data processor" }, explanation: { vi: "M√¥ h√¨nh Turing gi·ªõi thi·ªáu kh√°i ni·ªám 'ch∆∞∆°ng tr√¨nh' (program), bi·∫øn m√°y t√≠nh t·ª´ m·ªôt thi·∫øt b·ªã chuy√™n d·ª•ng th√†nh m·ªôt thi·∫øt b·ªã ƒëa nƒÉng.", en: "The Turing model introduced the concept of a 'program', transforming the computer from a special-purpose device to a general-purpose one." }, tip: { vi: "Turing = Program. Ch√≠nh ch∆∞∆°ng tr√¨nh l√†m cho m√°y t√≠nh tr·ªü n√™n 'v·∫°n nƒÉng'.", en: "Turing = Program. The program is what makes a computer 'universal'." } },
                { question: { vi: "ƒê·ªôt ph√° c·ªßa m√¥ h√¨nh von Neumann l√† g√¨?", en: "What was the breakthrough of the von Neumann model?" }, options: [{ vi: "Ph√°t minh ra b√≥ng b√°n d·∫´n", en: "Invention of the transistor" }, { vi: "Kh√°i ni·ªám ch∆∞∆°ng tr√¨nh ƒë∆∞·ª£c l∆∞u tr·ªØ (stored-program concept)", en: "The stored-program concept" }, { vi: "S·ª≠ d·ª•ng h·ªá nh·ªã ph√¢n", en: "The use of the binary system" }, { vi: "Ph√°t minh ra Internet", en: "Invention of the Internet" }], answer: { vi: "Kh√°i ni·ªám ch∆∞∆°ng tr√¨nh ƒë∆∞·ª£c l∆∞u tr·ªØ (stored-program concept)", en: "The stored-program concept" }, explanation: { vi: "Von Neumann ƒë·ªÅ xu·∫•t r·∫±ng c·∫£ ch∆∞∆°ng tr√¨nh v√† d·ªØ li·ªáu ƒë·ªÅu n√™n ƒë∆∞·ª£c l∆∞u tr·ªØ trong c√πng m·ªôt b·ªô nh·ªõ, gi√∫p vi·ªác thay ƒë·ªïi t√°c v·ª• c·ªßa m√°y t√≠nh tr·ªü n√™n c·ª±c k·ª≥ linh ho·∫°t.", en: "Von Neumann proposed that both programs and data should be stored in the same memory, making it extremely flexible to change the computer's task." }, tip: { vi: "Von Neumann = Program + Data TOGETHER in Memory.", en: "Von Neumann = Program + Data TOGETHER in Memory." } },
                // Th√™m c√°c c√¢u h·ªèi kh√°c ·ªü ƒë√¢y v·ªõi c·∫•u tr√∫c t∆∞∆°ng t·ª±...
                // ... (To√†n b·ªô 35 c√¢u h·ªèi ƒëa ng√¥n ng·ªØ)
                { question: { vi: "Thanh ghi n√†o trong CPU gi·ªØ ƒë·ªãa ch·ªâ c·ªßa ch·ªâ th·ªã K·∫æ TI·∫æP?", en: "Which register in the CPU holds the address of the NEXT instruction?" }, options: [{ vi: "Instruction Register (IR)", en: "Instruction Register (IR)" }, { vi: "Program Counter (PC)", en: "Program Counter (PC)" }, { vi: "Accumulator (AC)", en: "Accumulator (AC)" }, { vi: "Data Register", en: "Data Register" }], answer: { vi: "Program Counter (PC)", en: "Program Counter (PC)" }, explanation: { vi: "Program Counter (PC) ho·∫°t ƒë·ªông nh∆∞ m·ªôt d·∫•u trang, lu√¥n tr·ªè ƒë·∫øn v·ªã tr√≠ c·ªßa l·ªánh ti·∫øp theo c·∫ßn th·ª±c thi. Sau m·ªói l·∫ßn n·∫°p l·ªánh, gi√° tr·ªã c·ªßa PC s·∫Ω tƒÉng l√™n.", en: "The Program Counter (PC) acts like a bookmark, always pointing to the memory location of the next instruction to be fetched and executed. After each fetch, the PC is incremented." }, tip: { vi: "'Counter' l√† 'b·ªô ƒë·∫øm' ƒë·∫øm qua t·ª´ng d√≤ng l·ªánh.", en: "Think of 'Counter' as counting through the program's lines of code." } },
                { question: { vi: "Ki·∫øn tr√∫c CISC (Complex Instruction Set Computer) c√≥ ƒë·∫∑c ƒëi·ªÉm g√¨?", en: "What is a characteristic of CISC (Complex Instruction Set Computer) architecture?" }, options: [{ vi: "T·∫≠p l·ªánh nh·ªè, ƒë∆°n gi·∫£n", en: "Small, simple instruction set" }, { vi: "Ch·ªâ d√πng trong di ƒë·ªông", en: "Only used in mobile devices" }, { vi: "M·ªôt ch·ªâ th·ªã c√≥ th·ªÉ th·ª±c hi·ªán nhi·ªÅu thao t√°c ph·ª©c t·∫°p", en: "One instruction can perform multiple complex operations" }, { vi: "Y√™u c·∫ßu vi·∫øt nhi·ªÅu l·ªánh h∆°n", en: "Requires programmers to write more instructions" }], answer: { vi: "M·ªôt ch·ªâ th·ªã c√≥ th·ªÉ th·ª±c hi·ªán nhi·ªÅu thao t√°c ph·ª©c t·∫°p", en: "One instruction can perform multiple complex operations" }, explanation: { vi: "CISC ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·ªÉ m·ªôt l·ªánh m√°y c√≥ th·ªÉ th·ª±c hi·ªán m·ªôt t√°c v·ª• ph·ª©c t·∫°p. ƒêi·ªÅu n√†y gi√∫p l·∫≠p tr√¨nh d·ªÖ h∆°n nh∆∞ng l√†m cho ph·∫ßn c·ª©ng CPU ph·ª©c t·∫°p h∆°n.", en: "CISC is designed so that a single machine instruction can execute a complex task. This makes programming easier but complicates the CPU hardware." }, tip: { vi: "C trong CISC l√† 'Complex' (ph·ª©c t·∫°p). M·ªôt l·ªánh ph·ª©c t·∫°p, l√†m nhi·ªÅu vi·ªác.", en: "The C in CISC stands for 'Complex'. One complex instruction does a lot of work." } },
                { question: { vi: "B·ªô nh·ªõ Cache (Cache Memory) c√≥ m·ª•c ƒë√≠ch g√¨?", en: "What is the purpose of Cache Memory?" }, options: [{ vi: "L∆∞u tr·ªØ d·ªØ li·ªáu l√¢u d√†i", en: "Long-term data storage" }, { vi: "TƒÉng t·ªëc ƒë·ªô truy c·∫≠p d·ªØ li·ªáu cho CPU", en: "To speed up data access for the CPU" }, { vi: "Giao ti·∫øp v·ªõi thi·∫øt b·ªã ngo·∫°i vi", en: "To communicate with peripheral devices" }, { vi: "Thay th·∫ø ho√†n to√†n cho RAM", en: "To completely replace RAM" }], answer: { vi: "TƒÉng t·ªëc ƒë·ªô truy c·∫≠p d·ªØ li·ªáu cho CPU", en: "To speed up data access for the CPU" }, explanation: { vi: "Cache l√† m·ªôt lo·∫°i b·ªô nh·ªõ nh·ªè nh∆∞ng r·∫•t nhanh, n·∫±m gi·ªØa CPU v√† RAM. N√≥ l∆∞u tr·ªØ c√°c d·ªØ li·ªáu v√† ch·ªâ th·ªã ƒë∆∞·ª£c s·ª≠ d·ª•ng th∆∞·ªùng xuy√™n, gi√∫p CPU kh√¥ng ph·∫£i ch·ªù ƒë·ª£i RAM.", en: "Cache is a small but very fast memory located between the CPU and RAM. It stores frequently used data and instructions, preventing the CPU from having to wait for the much slower RAM." }, tip: { vi: "Cache = 'B·ªô nh·ªõ ƒë·ªám' si√™u t·ªëc cho CPU.", en: "Cache = A high-speed 'buffer memory' for the CPU." } },
                { question: { vi: "ROM (Read-Only Memory) l√† lo·∫°i b·ªô nh·ªõ g√¨?", en: "What type of memory is ROM (Read-Only Memory)?" }, options: [{ vi: "Kh·∫£ bi·∫øn (m·∫•t d·ªØ li·ªáu khi t·∫Øt ngu·ªìn)", en: "Volatile (loses data on power off)" }, { vi: "B·∫•t bi·∫øn (kh√¥ng m·∫•t d·ªØ li·ªáu khi t·∫Øt ngu·ªìn)", en: "Non-volatile (retains data on power off)" }, { vi: "Nhanh nh∆∞ng dung l∆∞·ª£ng nh·ªè", en: "Fast but with small capacity" }, { vi: "Ch·ªâ d√πng cho t√≠nh to√°n", en: "Used only for calculations" }], answer: { vi: "B·∫•t bi·∫øn (kh√¥ng m·∫•t d·ªØ li·ªáu khi t·∫Øt ngu·ªìn)", en: "Non-volatile (retains data on power off)" }, explanation: { vi: "ROM l√† b·ªô nh·ªõ ch·ªâ ƒë·ªçc, n·ªôi dung c·ªßa n√≥ ƒë∆∞·ª£c nh√† s·∫£n xu·∫•t ghi s·∫µn v√† kh√¥ng b·ªã m·∫•t ƒëi khi ng·∫Øt ngu·ªìn ƒëi·ªán. N√≥ th∆∞·ªùng ch·ª©a c√°c ch∆∞∆°ng tr√¨nh kh·ªüi ƒë·ªông thi·∫øt y·∫øu c·ªßa m√°y t√≠nh (BIOS/UEFI).", en: "ROM is read-only memory; its contents are written by the manufacturer and are not lost when power is turned off. It typically contains the computer's essential startup programs (BIOS/UEFI)." }, tip: { vi: "Read-Only = Ch·ªâ ƒê·ªçc. D·ªØ li·ªáu l√† vƒ©nh vi·ªÖn.", en: "Read-Only. The data is permanent." } },
                { question: { vi: "Ph∆∞∆°ng th·ª©c n√†o cho ph√©p thi·∫øt b·ªã I/O t·ªëc ƒë·ªô cao truy·ªÅn d·ªØ li·ªáu tr·ª±c ti·∫øp ƒë·∫øn b·ªô nh·ªõ?", en: "Which method allows high-speed I/O devices to transfer data directly to memory?" }, options: [{ vi: "Programmed I/O", en: "Programmed I/O" }, { vi: "Interrupt-driven I/O", en: "Interrupt-driven I/O" }, { vi: "Direct Memory Access (DMA)", en: "Direct Memory Access (DMA)" }, { vi: "Memory-mapped I/O", en: "Memory-mapped I/O" }], answer: { vi: "Direct Memory Access (DMA)", en: "Direct Memory Access (DMA)" }, explanation: { vi: "DMA ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·ªÉ gi·∫£i ph√≥ng CPU kh·ªèi c√¥ng vi·ªác truy·ªÅn d·ªØ li·ªáu. CPU ch·ªâ c·∫ßn ra l·ªánh cho b·ªô ƒëi·ªÅu khi·ªÉn DMA, sau ƒë√≥ c√≥ th·ªÉ l√†m vi·ªác kh√°c.", en: "DMA is designed to free up the CPU from the time-consuming task of data transfer. The CPU only needs to issue a command to the DMA controller and can then perform other tasks." }, tip: { vi: "Direct Memory Access = Truy c·∫≠p b·ªô nh·ªõ TR·ª∞C TI·∫æP.", en: "Direct Memory Access = Accessing memory DIRECTLY." } },
                { question: { vi: "Ki·∫øn tr√∫c RISC (Reduced Instruction Set Computer) th∆∞·ªùng th·∫•y ·ªü ƒë√¢u?", en: "Where is RISC (Reduced Instruction Set Computer) architecture commonly found?" }, options: [{ vi: "M√°y ch·ªß hi·ªáu nƒÉng cao", en: "High-performance servers" }, { vi: "H·∫ßu h·∫øt c√°c thi·∫øt b·ªã di ƒë·ªông", en: "Most mobile devices" }, { vi: "C√°c m√°y t√≠nh th·∫ø h·ªá ƒë·∫ßu ti√™n", en: "First-generation computers" }, { vi: "Ch·ªâ trong si√™u m√°y t√≠nh", en: "Only in supercomputers" }], answer: { vi: "H·∫ßu h·∫øt c√°c thi·∫øt b·ªã di ƒë·ªông", en: "Most mobile devices" }, explanation: { vi: "Ki·∫øn tr√∫c RISC, v·ªõi ƒë·∫∑c ƒëi·ªÉm l√† t·∫≠p l·ªánh ƒë∆°n gi·∫£n v√† ti·∫øt ki·ªám nƒÉng l∆∞·ª£ng, l√† l·ª±a ch·ªçn l√Ω t∆∞·ªüng cho c√°c thi·∫øt b·ªã di ƒë·ªông. C√°c chip ARM l√† v√≠ d·ª• ƒëi·ªÉn h√¨nh.", en: "RISC architecture, with its simple and energy-efficient instruction set, is the ideal choice for mobile devices. ARM chips are a prime example." }, tip: { vi: "R = Reduced (gi·∫£m thi·ªÉu), ph√π h·ª£p cho thi·∫øt b·ªã nh·ªè g·ªçn, c·∫ßn ti·∫øt ki·ªám pin.", en: "R = Reduced, suitable for compact, battery-saving devices." } },
            ],

            uiStrings: {
                vi: {
                    main_title: "Ki·ªÉm Tra Ki·∫øn Th·ª©c M√°y T√≠nh",
                    main_subtitle: "Ch∆∞∆°ng 1 & 5",
                    welcome_title: "B·∫°n ƒë√£ s·∫µn s√†ng ƒë·ªÉ ki·ªÉm tra ki·∫øn th·ª©c c·ªßa m√¨nh?",
                    welcome_desc: "H·ªá th·ªëng s·∫Ω ch·ªçn ng·∫´u nhi√™n <strong>20 c√¢u h·ªèi</strong> t·ª´ ng√¢n h√†ng c√¢u h·ªèi v·ªÅ c√°c kh√°i ni·ªám n·ªÅn t·∫£ng v√† t·ªï ch·ª©c m√°y t√≠nh.",
                    start_btn: "B·∫Øt ƒê·∫ßu",
                    next_btn: "C√¢u ti·∫øp theo",
                    restart_btn: "L√†m l·∫°i t·ª´ ƒë·∫ßu",
                    question_counter: (current, total) => `C√¢u ${current} / ${total}`,
                    score_counter: (score) => `ƒêi·ªÉm: ${score}`,
                    explanation_title: "üìù Gi·∫£i th√≠ch:",
                    tip_title: "üí° M·∫πo ghi nh·ªõ:",
                    correct_feedback: "üéâ Ch√≠nh x√°c! Tuy·ªát v·ªùi!",
                    incorrect_feedback: "üò• Ch∆∞a ƒë√∫ng!",
                    end_title: "Ho√†n th√†nh b√†i ki·ªÉm tra!",
                    final_score: (score, total) => `ƒêi·ªÉm s·ªë c·ªßa b·∫°n: ${score} / ${total}`,
                    score_message_perfect: "Ho√†n h·∫£o! B·∫°n l√† m·ªôt chuy√™n gia th·ª±c th·ª•!",
                    score_message_good: "R·∫•t t·ªët! B·∫°n ƒë√£ n·∫Øm v·ªØng h·∫ßu h·∫øt ki·∫øn th·ª©c.",
                    score_message_ok: "Kh√° ·ªïn! H√£y √¥n l·∫°i m·ªôt ch√∫t ƒë·ªÉ ho√†n thi·ªán h∆°n nh√©.",
                    score_message_bad: "ƒê·ª´ng lo l·∫Øng! M·ªói l·∫ßn l√†m l·∫°i l√† m·ªôt l·∫ßn h·ªçc h·ªèi. C·ªë l√™n!",
                },
                en: {
                    main_title: "Computer Science Knowledge Quiz",
                    main_subtitle: "Chapters 1 & 5",
                    welcome_title: "Ready to test your knowledge?",
                    welcome_desc: "The system will randomly select <strong>20 questions</strong> from the question bank on fundamental concepts and computer organization.",
                    start_btn: "Start",
                    next_btn: "Next Question",
                    restart_btn: "Restart Quiz",
                    question_counter: (current, total) => `Question ${current} / ${total}`,
                    score_counter: (score) => `Score: ${score}`,
                    explanation_title: "üìù Explanation:",
                    tip_title: "üí° Memory Tip:",
                    correct_feedback: "üéâ Correct! Excellent!",
                    incorrect_feedback: "üò• Not quite!",
                    end_title: "Quiz Completed!",
                    final_score: (score, total) => `Your score: ${score} / ${total}`,
                    score_message_perfect: "Perfect! You're a true expert!",
                    score_message_good: "Great job! You have a solid understanding.",
                    score_message_ok: "Not bad! A little more review will make you perfect.",
                    score_message_bad: "Don't worry! Every attempt is a learning opportunity. Keep it up!",
                }
            },
            
            domElements: {},
            state: {},

            init() {
                this.domElements = {
                    startScreen: document.getElementById('start-screen'), quizScreen: document.getElementById('quiz-screen'), scoreScreen: document.getElementById('score-screen'),
                    startBtn: document.getElementById('start-btn'), restartBtn: document.getElementById('restart-btn'), nextBtn: document.getElementById('next-btn'), translateBtn: document.getElementById('translate-btn'),
                    questionEl: document.getElementById('question'), optionsContainer: document.getElementById('options-container'), resultContainer: document.getElementById('result-container'),
                    questionCounterEl: document.getElementById('question-counter'), scoreCounterEl: document.getElementById('score-counter'),
                    finalScoreEl: document.getElementById('final-score'), finalMessageEl: document.getElementById('final-message'),
                    resultTextEl: document.getElementById('result-text'), explanationTextEl: document.getElementById('explanation-text'), tipTextEl: document.getElementById('tip-text'),
                };
                this.state = { currentLanguage: 'vi' };
                this.domElements.startBtn.addEventListener('click', () => this.startQuiz());
                this.domElements.restartBtn.addEventListener('click', () => this.startQuiz());
                this.domElements.nextBtn.addEventListener('click', () => this.handleNext());
                this.domElements.translateBtn.addEventListener('click', () => this.toggleLanguage());
                this.translateUI();
            },

            startQuiz() {
                this.domElements.startScreen.classList.add('hide');
                this.domElements.scoreScreen.classList.add('hide');
                this.domElements.quizScreen.classList.remove('hide');

                const allQuestions = [...this.questionBank];
                this.shuffleArray(allQuestions);
                this.state = {
                    ...this.state,
                    shuffledQuestions: allQuestions.slice(0, 20),
                    currentQuestionIndex: 0,
                    score: 0,
                    totalQuestions: 20,
                };
                
                this.updateScoreCounter();
                this.showQuestion();
            },

            showQuestion() {
                this.resetState();
                const lang = this.state.currentLanguage;
                const currentQuestion = this.state.shuffledQuestions[this.state.currentQuestionIndex];
                this.domElements.questionEl.innerText = currentQuestion.question[lang];
                this.domElements.questionCounterEl.innerText = this.uiStrings[lang].question_counter(this.state.currentQuestionIndex + 1, this.state.totalQuestions);

                currentQuestion.options.forEach(optionObj => {
                    const button = document.createElement('button');
                    button.innerText = optionObj[lang];
                    button.classList.add('option-btn');
                    button.addEventListener('click', (e) => this.selectAnswer(e));
                    this.domElements.optionsContainer.appendChild(button);
                });
            },

            selectAnswer(e) {
                const selectedButton = e.target;
                const lang = this.state.currentLanguage;
                const currentQuestion = this.state.shuffledQuestions[this.state.currentQuestionIndex];
                const isCorrect = selectedButton.innerText === currentQuestion.answer[lang];

                if (isCorrect) {
                    this.state.score++;
                    this.domElements.resultTextEl.innerText = this.uiStrings[lang].correct_feedback;
                    this.domElements.resultTextEl.style.color = 'var(--correct-color)';
                } else {
                    this.domElements.resultTextEl.innerText = this.uiStrings[lang].incorrect_feedback;
                    this.domElements.resultTextEl.style.color = 'var(--incorrect-color)';
                    selectedButton.classList.add('incorrect');
                }
                this.updateScoreCounter();

                Array.from(this.domElements.optionsContainer.children).forEach(button => {
                    if (button.innerText === currentQuestion.answer[lang]) {
                        button.classList.add('correct');
                    }
                    button.disabled = true;
                });
                
                this.domElements.explanationTextEl.innerText = currentQuestion.explanation[lang];
                this.domElements.tipTextEl.innerText = currentQuestion.tip[lang];
                this.domElements.resultContainer.classList.remove('hide');
                this.domElements.nextBtn.classList.remove('hide');
            },
            
            handleNext() {
                this.state.currentQuestionIndex++;
                if (this.state.currentQuestionIndex < this.state.totalQuestions) {
                    this.showQuestion();
                } else {
                    this.showScore();
                }
            },

            showScore() {
                this.domElements.quizScreen.classList.add('hide');
                this.domElements.scoreScreen.classList.remove('hide');
                const lang = this.state.currentLanguage;
                const { score, totalQuestions } = this.state;
                this.domElements.finalScoreEl.innerText = this.uiStrings[lang].final_score(score, totalQuestions);
                
                let message = '';
                const percentage = (score / totalQuestions) * 100;
                if (percentage === 100) message = this.uiStrings[lang].score_message_perfect;
                else if (percentage >= 80) message = this.uiStrings[lang].score_message_good;
                else if (percentage >= 50) message = this.uiStrings[lang].score_message_ok;
                else message = this.uiStrings[lang].score_message_bad;
                this.domElements.finalMessageEl.innerText = message;
            },

            updateScoreCounter() {
                const lang = this.state.currentLanguage;
                this.domElements.scoreCounterEl.innerText = this.uiStrings[lang].score_counter(this.state.score);
            },
            
            resetState() {
                while (this.domElements.optionsContainer.firstChild) {
                    this.domElements.optionsContainer.removeChild(this.domElements.optionsContainer.firstChild);
                }
                this.domElements.nextBtn.classList.add('hide');
                this.domElements.resultContainer.classList.add('hide');
            },

            shuffleArray(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
            },

            toggleLanguage() {
                this.state.currentLanguage = this.state.currentLanguage === 'vi' ? 'en' : 'vi';
                this.translateUI();
                
                // Re-render the current view if the quiz is in progress or finished
                if (!this.domElements.quizScreen.classList.contains('hide')) {
                     this.showQuestion();
                     // If an answer was already selected, re-show the result in the new language
                     if (!this.domElements.nextBtn.classList.contains('hide')) {
                         this.selectAnswer({ target: this.domElements.optionsContainer.querySelector('.correct, .incorrect') });
                     }
                } else if (!this.domElements.scoreScreen.classList.contains('hide')) {
                    this.showScore();
                }
            },

            translateUI() {
                const lang = this.state.currentLanguage;
                this.domElements.translateBtn.innerText = lang === 'vi' ? 'EN' : 'VI';
                
                // Translate all static elements with data-key attribute
                document.querySelectorAll('[data-key]').forEach(el => {
                    const key = el.dataset.key;
                    if (this.uiStrings[lang][key]) {
                        el.innerHTML = this.uiStrings[lang][key];
                    }
                });
                 this.updateScoreCounter();
            }
        };

        document.addEventListener('DOMContentLoaded', () => {
            quizApp.init();
        });
    </script>
</body>
</html>